# Top-level env group definition
envVarGroups:
  - name: n8n-secrets

previews:
  generation: automatic

services:
  - type: web
    name: n8n-service
    plan: standard
    dockerfilePath: Dockerfile

    previews:
      generation: automatic
      plan: standard

    envVars:
      - key: WEBHOOK_URL
        value: https://<your-app>.onrender.com/
        previewValue: https://app-pr-${RENDER_PR_NUMBER}.onrender.com/
      - key: API_ENDPOINT
        value: https://<your-app>.onrender.com/
        previewValue: https://app-pr-${RENDER_PR_NUMBER}.onrender.com/
      - fromGroup: n8n-secrets

    startCommand: |
      ngrok authtoken $NGROK_TOKEN
      ngrok http 5678 --log=stdout &
      n8n

databases:
  - name: n8n-db
    plan: basic-256mb
